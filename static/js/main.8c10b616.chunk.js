(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,,,function(e,t,a){e.exports=a(24)},,,,,function(e,t,a){},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAA7EAAAOxAGVKw4bAAACQElEQVRIiZWVP2iUQRDF31sOOY5DRCSIpBAri1SWVlZa2GpISgt7axtJISJWFjaWNtrYxFYF8Q+CIgaUaKWCilwhGCRIiPOzuN1z7+67u9yDj53dnX0zO9/MrJUBtCVdk7QsqSMp5fWkCrZDzfgBXLF9z/Z//Uwi4Krty5J+SvoNRCaUpEmkxYEkacH2rqQztl+MKrUjYgP4FRFLQCsiEpDKmGVFhIpc7beAS/SxVnO38pgkJWDL9vfsyTTE6Ah8yHKnVhzE17ZsRwnNvACKU0P/rJ4kYB7CoXl16yEHS6aUA1FnwBTyfcAT4HrOPkl6DdwZNVAOdID3wCfgwCwDEdEFNoG/wF3gYOZpA0uNN5gHtlUyS9KKpAfAgu0/tt/Vuq3qQJOnRyXdlNQtOnlsSVqsnDtp+zlw3vbbMaJJIQKWmQ/fgNO1s4N20HSDslbvzZCPAPclrZS9VEKkkfxtCt1eZPXD3i49rFUUJqXnUOOaLfdsX5S0nlIaWJtILumNpIeSutUPlu1WTsd2dfYzsJpSejnGAnQjYjMi9lQHWf9jRBARAK+AxSbd0V40i3sA25G/dUlnbX/NFX680UBTxky5wQ7QA25LWrXdi4iOpFuSLowdiIgSoi97CVGTI8CpXAs36vXyHkx7ChvREM76bRmg1EGo/2ikUYU5UAyMt2tJu8CO+ul4aN7ml3Esj9tNVndsP5Z0QtJTSVv0X7byzUJpftuSHo0ZsK2IWLO9Hzhn+/AkprrqR+Se7TVJz2r9f9bS+B8jtyFhAAAAAElFTkSuQmCC"},function(e,t,a){},,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),o=a(8),r=a.n(o),l=a(1),c=a(2),i=a(4),u=a(3),m=a(5),g=(a(16),function(e){function t(){var e,a;Object(l.a)(this,t);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).logOutHandler=function(e){e.target.classList.contains("chat-status")||a.props.logOut()},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e="chat-status chat-status_".concat(this.props.chatStatus),t="Welcome to The Rolling Scopes School chat",s=this.props.user?n.a.createElement(n.a.Fragment,null,"Hello, ",n.a.createElement("span",{className:"welcome__name"},this.props.user," "),"! ",t," "):n.a.createElement(n.a.Fragment,null,t,n.a.createElement("span",{className:"welcome__login_mobile"},"RSS chat")," ");return n.a.createElement("header",{className:"header"},n.a.createElement("h2",{className:"welcome header__welcome"},s),this.props.user&&n.a.createElement("div",{onClick:this.logOutHandler,className:"logout header__logout"},n.a.createElement("span",{className:e,title:"Chat status: "+this.props.chatStatus}),"Log out",n.a.createElement("img",{className:"logout__img",src:a(17),alt:"Log Out"})))}}]),t}(s.Component)),h=(a(18),function(e){function t(){var e,a;Object(l.a)(this,t);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state={value:""},a.changeHandler=function(e){a.setState({value:e.target.value})},a.submitHandler=function(e){e.preventDefault(),a.state.value.replace(/ /g,"").length>0&&a.props.logIn(a.state.value)},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.a.createElement("section",{className:"login"},n.a.createElement(g,null),n.a.createElement("form",{onSubmit:this.submitHandler,className:"login__form"},n.a.createElement("input",{type:"text",value:this.state.value,onChange:this.changeHandler,className:"login__user",placeholder:"Enter your username",maxLength:"15",autoFocus:!0,required:!0}),n.a.createElement("input",{type:"submit",value:"Start chatting!",className:"login__enter"})))}}]),t}(s.Component)),f=a(6),p=a(9),d=a(10),S=a.n(d),b=(a(20),function(e){function t(){var e,a;Object(l.a)(this,t);for(var s=arguments.length,o=new Array(s),r=0;r<s;r++)o[r]=arguments[r];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).messagesContainer=n.a.createRef(),a.updateScroll=function(){a.messagesContainer.current.scrollTop=a.messagesContainer.current.scrollHeight},a.buttonClickHandler=function(){a.props.loadMoreMessages()},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getMessages",value:function(e){return 0===e.length?[]:e.map(function(e){return n.a.createElement("div",{key:S()(),className:"message messages-container__message"},n.a.createElement("span",{className:"message__author"},e.from),n.a.createElement("span",{className:"message__date"}," ",p(e.time).format("MMM Do, h:mm a")),n.a.createElement("p",{className:"message__text"},e.message))})}},{key:"render",value:function(){var e=this.getMessages(this.props.messages),t=this.props.loadMoreButton?"load-more_active":"load-more_disabled";return n.a.createElement("div",{ref:this.messagesContainer,className:"messages-container"},n.a.createElement("button",{onClick:this.buttonClickHandler,className:"messages-container__load-more "+t},"Load more"),e)}}]),t}(s.Component)),v=(a(21),function(e){function t(){var e,a;Object(l.a)(this,t);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state={value:""},a.changeHandler=function(e){a.setState({value:e.target.value})},a.keyDownHandler=function(e){13===e.keyCode&&(e.preventDefault(),a.submitHandler(e))},a.submitHandler=function(e){e.preventDefault(),a.props.sendMessage(a.state.value),a.setState({value:""})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.a.createElement("form",{onSubmit:this.submitHandler,className:"user-message"},n.a.createElement("textarea",{value:this.state.value,onChange:this.changeHandler,onKeyDown:this.keyDownHandler,className:"user-message__textarea",rows:"2",placeholder:"Type your message ..."}),n.a.createElement("input",{type:"submit",className:"user-message__send",title:"Send"}))}}]),t}(s.Component)),O=(a(22),function(e){function t(){var e,a;Object(l.a)(this,t);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state={allMessages:[],lastMessages:[],loadMoreButton:null,chatStatus:"offline"},a.webSocket=null,a.componentDidMount=function(){a.connectToChat(),"granted"!==Notification.permission&&Notification.requestPermission()},a.componentWillUnmount=function(){a.webSocket.removeEventListener("close",a.reconnect)},a.logOut=function(){localStorage.removeItem("user"),a.setState({chatStatus:"offline"}),a.webSocket.close(),a.props.logOut()},a.connectToChat=function(){a.webSocket=new WebSocket("wss://wssproxy.herokuapp.com/"),a.webSocket.onopen=function(){a.setState({chatStatus:"online"}),a.state.allMessages.length>50&&a.setState({loadMoreButton:"active"})},a.webSocket.addEventListener("close",a.reconnect),a.webSocket.onerror=function(){return a.webSocket.close()},a.webSocket.onmessage=function(e){var t=JSON.parse(e.data);0===a.state.allMessages.length&&a.setState({allMessages:t});var s=a.state.allMessages,n=0===a.state.lastMessages.length?Object(f.a)(s.slice(0,50).reverse()):[].concat(Object(f.a)(a.state.lastMessages),Object(f.a)(t));a.setState({lastMessages:n}),s.length>50&&a.setState({loadMoreButton:"active"}),a.refs.messagesContainer&&a.refs.messagesContainer.updateScroll(),document.hidden&&a.notifyUser()}},a.loadMoreMessages=function(){var e=a.state.lastMessages.length,t=a.state.allMessages.length>e+50?e+50:a.state.allMessages.length,s=a.state.allMessages.slice(e,t).reverse();a.setState({lastMessages:[].concat(Object(f.a)(s),Object(f.a)(a.state.lastMessages))}),t===a.state.allMessages.length&&a.setState({loadMoreButton:null})},a.sendMessage=function(e){var t={from:a.props.user,message:e};1===a.webSocket.readyState&&a.webSocket.send(JSON.stringify(t))},a.reconnect=function(){a.setState({chatStatus:"offline"}),setTimeout(function(){a.connectToChat()},1e3)},a.notifyUser=function(){"granted"===Notification.permission&&new Notification("RSS chat",{icon:"https://yt3.ggpht.com/a/AGF-l7_XBv-WdGb5TSh9COVN7GK75B2NQrzAZmdhdw=s900-c-k-c0xffffffff-no-rj-mo",body:"Hey there! You have at least 1 unread message in The Rolling Scopes School chat."})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement(g,{user:this.props.user,logOut:this.logOut,chatStatus:this.state.chatStatus}),n.a.createElement("main",{className:"chat-room"},n.a.createElement("section",{className:"chat chat-room__chat"},n.a.createElement(b,{messages:this.state.lastMessages,ref:"messagesContainer",loadMoreMessages:this.loadMoreMessages,loadMoreButton:this.state.loadMoreButton}),n.a.createElement(v,{sendMessage:this.sendMessage}))))}}]),t}(s.Component)),A=(a(23),function(e){function t(){var e,a;Object(l.a)(this,t);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state={user:null},a.logIn=function(e){localStorage.setItem("user",e),a.setState({user:e})},a.logOut=function(){a.setState({user:null})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.a.createElement(n.a.Fragment,null,this.state.user||localStorage.getItem("user")?n.a.createElement(O,{logOut:this.logOut,user:localStorage.getItem("user")||this.state.user}):n.a.createElement(h,{logIn:this.logIn,user:this.state.user}))}}]),t}(s.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(n.a.createElement(A,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}],[[11,1,2]]]);
//# sourceMappingURL=main.8c10b616.chunk.js.map